#:kivy 1.8.0
#import KivCamera kivyCamera
<CameraScreen>:
    id: camera_screen
    #:import platform kivy.utils
    BoxLayout:
        orientation: 'vertical'
        Widget:
            # invert width/height on rotated Android
            # https://stackoverflow.com/a/45192295/185510
            id: proxy
            Camera:
                id: cam
                keep_ratio: True
                allow_stretch: True
                resolution: self.resolution
                center: self.size and proxy.center
                size:
                    (proxy.height, proxy.width) if platform == 'android' \
                    else (proxy.width, proxy.height)
                # Android camera rotation workaround, refs:
                # https://github.com/AndreMiras/garden.zbarcam/issues/3
                canvas.before:
                    PushMatrix
                    Rotate:
                        angle: -90 if platform == 'android' else 0
                        origin: self.center
                canvas.after:
                    PopMatrix
        Label:
            size_hint: None, None
            size: self.texture_size[0], 50
            text: ', '.join([str(symbol.data) for symbol in camera_screen.symbols])
        Button:
            text: 'Back to menu'
            on_press: 
                app.remove_scanner_screen()